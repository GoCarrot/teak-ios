#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

ls Teak/*.[hm] | xargs clang-format -i -style=file

infer run -- xcodebuild -project Teak.xcodeproj -sdk iphoneos -target Framework -configuration Release BUILD_DIR=./build OTHER_CFLAGS="-fembed-bitcode"
(cd build/Release-iphoneos/; zip -y -r Teak.framework.zip Teak.framework/)
